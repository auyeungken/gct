<html>
    <head>
        <meta charset="UTF-8"> 
        <!-- aes from https://github.com/mdp/gibberish-aes echo "U2FsdGVkX1+21O5RB08bavFTq7Yq/gChmXrO3f00tvJaT55A5pPvqw0zFVnHSW1o" | openssl enc -d -aes-256-cbc -a -k password -md md5 -->
        <script type="text/javascript" src="js/aes.js"></script>
        <script type="text/javascript" src="js/web3.min.js"></script>
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/KISS07.js"></script>
        <script type="text/javascript" src="js/Mash.js"></script>
        <script type="text/javascript" src="js/bignumber.min.js"></script>
        <script type="text/javascript" src="js/common.js"></script>
        <script type="text/javascript" src="contract/GCToken.js"></script>
        <script type="text/javascript" src="contract/GCTCrowdsale.js"></script>
        <script>
            GibberishAES.size(256);
            var random = KISS07();
            var web3 = new Web3("http://localhost:8545");

            function rand(min,max){
                var n = max - min + 1;
                return Math.floor(random() * n) + min;
            }
            function generateRandomStr(numChar){
                var s = "";
                for(var i=0; i < numChar; i++){
                    s+=String.fromCharCode(rand(33,126));
                }
                return s;
            }

            function loadPage(p){
                $('#__content__').load(p);
            }

            function contractAt(addr, abi){
                return web3.eth.contract(abi).at(addr);
            }

            async function getBalance(addr, raw){
                if(addr.trim()==='')return NaN;
                let v = new BigNumber(await web3.eth.getBalance(addr));
                if(!raw) v = v.div("1e+18");
                return v;
            }

            async function displayBal(addr, obj){
                let bal = await getBalance(addr);
                $(obj).html(bal.toString() + "ETH");
            }

            function convertToWei(amt, unit){
                if(!unit) unit = "18";
                if($.isNumeric(amt)){
                    return new BigNumber(amt).times('1e+'+unit);
                }
                return NaN;
            }
            function getPrivateKey(){
                let obj = $("#privateKeySec");
                let pkey = obj.find("#privatekey").val();
                if(pkey.trim() === ""){
                    pkey = GibberishAES.dec(obj.find("#encprivatekey").val(), obj.find("#password").val());
                }
                return pkey;
            }
            async function loadAcctInfo(){
                let acct = web3.eth.accounts.privateKeyToAccount(getPrivateKey());
                let bal = await getBalance(acct.address);
                let obj = $("#privateKeySec");
                obj.find('#sendaddress').html(acct.address);
                obj.find('#balance').html(bal + "ETH");
            }
        </script>
        <style>
            input[type=text] {
                width:500px;
            }
            .require{
                color:red;
            }
            .important {
                color:red;
            }
        </style>
    </head>
    <body>
        <table style="width:100%">
            <tr>
                <td>
                    <input type="button" onclick="loadPage('createacct.html')" value="Create Account">
                    <input type="button" onclick="loadPage('transfer.html')" value="Transaction">
                    <input type="button" onclick="loadPage('gct.html')" value="GCT">
                    <input type="button" onclick="loadPage('crowdsale.html')" value="Crowdsale">
                    <input type="button" onclick="loadPage('deploy.html')" value="Deploy">
                </td>
            </tr>
            <tr>
                <td style="width:100%">
                    <div id="__content__" style="width:100%"></div>
                </td>
            </tr>
        </table>
    </body>
</html>